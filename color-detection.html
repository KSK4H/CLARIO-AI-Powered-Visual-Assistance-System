<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Clario | Object Color Detection</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background-color: #F4D03F;
            font-family: 'Georgia', serif;
            min-height: 100vh;
        }

        .card-box {
            background-color: #FCF3CF;
            width: 420px;
            margin: 100px auto;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            text-align: center;
        }

        h2 {
            font-weight: bold;
            margin-bottom: 25px;
        }

        .btn-main {
            background-color: #D68910;
            color: #FDEBD0;
            font-weight: bold;
            border: none;
            padding: 12px 22px;
            border-radius: 8px;
            width: 100%;
        }

        .btn-main:hover {
            background-color: #AF601A;
            color: white;
        }

        .btn-home {
            background-color: #1C2833;
            color: #F7F9F9;
            border: none;
            padding: 10px 22px;
            border-radius: 8px;
            margin-top: 10px;
            width: 100%;
        }

        .result-box {
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
        }

        audio {
            margin-top: 15px;
            width: 100%;
        }
    </style>
</head>

<body>

<div class="card-box">

    <h2>üé® Object Color Detection</h2>

    <!-- Start Camera -->
    <form action="/color-detect/start" method="post">
        <button 
            type="submit"
            class="btn-main"
            onmouseenter="hoverSpeak(this, 'Start object color detection')"
            onmouseleave="resetSpeak(this)">
            Start Camera
        </button>
    </form>

    <!-- Back to Home -->
    <form action="/" method="get">
        <button 
            type="submit"
            class="btn-home"
            onmouseenter="hoverSpeak(this, 'Back to home')"
            onmouseleave="resetSpeak(this)">
            ‚Üê Back to Home
        </button>
    </form>

    {% if result %}
        <div class="result-box">
            Result: {{ result }}
        </div>

        {% if audio %}
            <audio controls autoplay>
                <source src="/{{ audio }}" type="audio/mpeg">
            </audio>
        {% endif %}
    {% endif %}

</div>

<!-- üîä Voice Hover Script -->
<script>
    function hoverSpeak(element, text) {
        if (element.spoken) return;
        element.spoken = true;

        if (!window.speechSynthesis) return;

        window.speechSynthesis.cancel();

        const msg = new SpeechSynthesisUtterance(text);
        msg.lang = "en-US";
        msg.rate = 1;
        msg.pitch = 0.9;
        msg.volume = 1;

        const voices = speechSynthesis.getVoices();
        const maleVoice = voices.find(v =>
            v.lang.includes("en") &&
            (v.name.toLowerCase().includes("male") ||
             v.name.toLowerCase().includes("google") ||
             v.name.toLowerCase().includes("david"))
        );

        if (maleVoice) {
            msg.voice = maleVoice;
        }

        speechSynthesis.speak(msg);
    }

    function resetSpeak(element) {
        element.spoken = false;
    }

    // Ensure voices are loaded
    speechSynthesis.onvoiceschanged = () => {};
</script>

</body>
</html>
